<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RxJS  Demo</title>
</head>
<script src='../lib/rxjs6.3.3.umd.js'></script>
<script>
  const {of, range, interval, empty, throwError, } = rxjs;
  const {mapTo, startWith, scan, tap, map, take, skip, takeLast, last, merge, concat,
    filter, switchMap, concatAll, takeUntil, catchError, retry, mergeMap, } = rxjs.operators;

  console.log('demo1: ');
  // 每1秒发出值
  const source = interval(1000);
  const example = source.pipe(
    mergeMap(val => {
      // 抛出错误以进行演示
      if (val > 3) {
        return throwError('Error!');
      }
      return of(val);
    }),
    // 出错的话可以重试2次
    retry(2)
  );

  /*
    输出:
    0..1..2..3
    0..1..2..3
    0..1..2..3
    "Error!: Retried 2 times then quit!"
  */
  const subscribe = example.subscribe({
    next: val => console.log(val),
    error: val => console.log(`${val}: Retried 2 times then quit!`)
  });


</script>
</html>
